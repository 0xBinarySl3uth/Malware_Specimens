/*
String Hasing Method 2: JenkinsOneAtATime32Bit

References:
	- https://theartincode.stanis.me/008-djb2/

Description:
    This function computes a 32-bit hash value for an input string using the Jenkins One-At-A-Time hashing algorithm. 
    It iterates over the characters of the input string, updating a running hash value incrementally.
*/

#include <stdio.h>
#include <Windows.h>
#define SEED 7

UINT32 JenkinsOneAtAStimeA(_In_ PCHAR String) {
    // Declarations and Initialization
    SIZE_T Index = 0;
    UINT32 Hash = 0;
    SIZE_T Length = lstrlen(String);

    // Iterate through the characters and update the hash
    while (Index != Length) {
        // Update the hash with the current character
        Hash += String[Index++];
        // Left shift the hash by 'SEED' bits
        Hash += Hash << SEED;
        // XOR the hash to the right with 6 bits for mixing
        Hash ^= Hash >> 6;
    }

    // Additional bit manipulation for further mixing
    Hash += Hash << 3;
    Hash ^= Hash >> 11;
    Hash += Hash << 15;

    return Hash;
}

int main() {
    CHAR* cString = "0xBinarySl3uth";

    printf("[+] Hash Of [ \%s\ ] Is : 0x%.10X \n", cString, JenkinsOneAtAStimeA(cString));
    printf("Press <Enter> To Exit");
    getchar();
}